{"version":3,"sources":["webpack:///webpack/bootstrap 492fd8953920e7b3c833","webpack:///./src/main.js","webpack:///./src/descriptor.js"],"names":[],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 492fd8953920e7b3c833\n **/","'use strict';\n\nimport description from './descriptor.js';\n\nlet output = window.document.querySelector('.output');\nlet editor = window.document.querySelector('.editor');\n\nlet data = { toto: 'blue' };\n\neditor.addEventListener('input', event => {\n  console.log(editor.textContent);\n  output.textContent = description.parseDescriptionsFile(editor.textContent, data);\n});\n\n//pas mal : ^(\\w+):([\\s\\S]*?)(?=(^\\w))\nlet reqListener = function () {\n  let desc = this.responseText;\n  // console.log(desc);\n  editor.textContent = desc;\n  output.textContent = description.parseDescriptionsFile(desc, data);\n};\n\nlet oReq = new XMLHttpRequest();\noReq.addEventListener('load', reqListener);\noReq.open('GET', 'main.desc');\noReq.send();\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/main.js\n **/","let descriptor = {\n\n  parseDescriptionsFile: function (file, data) {\n    let parsedContent = descriptor.parseContent(file);\n    for (let name in parsedContent) {\n      parsedContent[name] = descriptor.parseContent(parsedContent[name]);\n    }\n\n    //var condition = \"(toto = 'blue' & 'green' = 'green') & 'red' = 'redd' | 'tutu' = 'tutu'\";\n    //var condition = 'toto';\n\n    return descriptor.getDescription('body', parsedContent, data);\n    //console.log('result', descriptor.getDescription('body', parsedContent, data));\n  },\n\n  parseContent: function (value) {\n    // let regex = /( *)(.+):\\n((?:\\1  .*[\\s]?)*)/gm;\n    //let regex = /( *)(.+):\\n((?:\\1\\s.*[\\s]?)*)/gm;\n\n    // celle la fonctionne dans regexr : /^( *)(.+):$\\n((?:(?:^\\1 .*\\n?)|^$\\n?)*)/gm\n    let regex = /(^ *)(.*):$\\s((?:(?:^\\1 .*$\\s?)|(?:^$\\s))*)/gm;\n    let result;\n    let parsed = {};\n\n    do {\n      result = regex.exec(value);\n      console.log(result);\n      if (!result) { break; }\n      let content = result[3];\n      content = content.replace(/^  /gm, '');\n      content = content.replace(/\\n$/, '');\n      parsed[result[2]] = content;\n    }\n    while (result);\n    // for(let name in parsed) {\n    //   console.log(name);\n    // }\n\n    return parsed;\n  },\n\n  parseExpression: function (expression, data) {\n    //console.log('parsing expression', expression);\n    if (expression.startsWith('\\'')) { return expression.replace(/'/g, ''); }\n    else { return data[expression]; }\n  },\n\n  evaluate: function (condition, data) {\n    //console.log('evaluate', condition);\n\n    let comparison = /(\\S*)?([=<>])(\\S*)?/;\n    let comparisonResult = comparison.exec(condition);\n    //console.log(comparisonResult);\n\n    if (comparisonResult) {\n      let expressionA = descriptor.parseExpression(comparisonResult[1], data);\n      let operand = comparisonResult[2];\n      let expressionB = descriptor.parseExpression(comparisonResult[3], data);\n\n      //console.log(condition, expressionA, operand, expressionB);\n\n      switch (operand) {\n        case '>':\n          return expressionA > expressionB;\n\n        case '<':\n          return expressionA < expressionB;\n\n        case '=':\n          return expressionA === expressionB;\n\n        default:\n          throw new Error('invalid evaluation');\n      }\n    }\n    else {\n      if (condition === '*') { return true; }\n      else { return descriptor.parseExpression(condition, data) !== undefined && descriptor.parseExpression(condition, data) !== false; }\n    }\n  },\n\n  stripFirstLevelParentheses: function (condition, data) {\n    let depth = 0;\n    let openedOnce = false;\n    let stripped = '';\n\n    var stringArray = Array.from(condition);\n    for (var i = 0, length = stringArray.length; i < length; i += 1)\n    {\n      var item = stringArray[i];\n\n      if (depth === 0 && ((item !== '(' && item !== ')') || openedOnce)) {\n        return condition;\n      }\n      else\n      {\n        if (item === '(') {\n          openedOnce = true;\n          depth += 1;\n        }\n        else if (item === ')')\n        {\n          depth -= 1;\n        }\n        else {\n          stripped += item;\n        }\n      }\n    }\n\n    return stripped;\n  },\n\n  parseCondition: function (condition, data) {\n    //console.log('parsing condition', condition);\n    let noSpace = condition.replace(/\\s/g, '');\n    return descriptor.performComparisons(noSpace, data);\n  },\n\n  performComparisons: function (condition, data) {\n    //console.log('performComparisons', condition);\n\n    condition = descriptor.stripFirstLevelParentheses(condition);\n\n    let testCondition = /[\\(\\)&\\|]/gm;\n    if (!testCondition.test(condition)) { return descriptor.evaluate(condition, data); }\n\n    let depth = 0;\n    let operand;\n    let index = 0;\n    let result;\n\n    let opened = false;\n    let beforeOperand = '';\n    let afterOperand = '';\n    let hasParenthesis = false;\n    let group = '';\n\n    let groups = [''];\n    let operands = [];\n\n    Array.from(condition).forEach(item => {\n      if (item === ')') {\n        depth -= 1;\n        if (depth === 0) {\n          opened = false;\n        }\n      }\n      if (item === '(') {\n        if (depth === 0) { opened = true; }\n        depth += 1;\n      }\n\n      if (depth === 0 && (item === '&' || item === '|')) {\n        groups.push('');\n        operands.push(item);\n      }\n      else\n      {\n        groups[groups.length - 1] += item;\n      }\n    });\n\n    var results = groups.map(item => descriptor.parseCondition(item, data));\n\n    while (results.length > 1) {\n      if (operands[0] === '&') {\n        results[1] = results[0] && results[1];\n      }\n      if (operands[0] === '|') {\n        results[1] = results[0] || results[1];\n      }\n      results.shift();\n      operands.shift();\n    }\n\n    return results[0];\n  },\n\n  getDescriptions: function (content, data) {\n    let toReturn = [];\n    for (var condition in content) {\n      if (descriptor.evaluate(condition, data)) {\n        toReturn.push(content[condition]);\n      }\n    }\n\n    return toReturn;\n  },\n\n  getAvailableDescs: function (descriptionList, data) {\n    let toReturn = [];\n    for (let conditionName in descriptionList) {\n      if (descriptor.parseCondition(conditionName, data)) {\n        toReturn.push(descriptionList[conditionName]);\n      }\n    }\n\n    if (toReturn.length === 0) {\n      throw new Error(`error no available descs : ${descriptionList} `);\n    }\n    return toReturn;\n  },\n\n  getDescription: function (contentName, contentList, data) {\n    let reference = /@(\\w*)(?=\\W)/gm;\n    let result;\n\n    return descriptor.getAvailableDescs(contentList[contentName], data)[0].replace(reference, (match, p1) => descriptor.getDescription(p1, contentList, data));\n  }\n};\n\nexport default descriptor;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/descriptor.js\n **/"],"sourceRoot":""}